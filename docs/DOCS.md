## Оглавление

0. [Общая информация](#0-общая-информация)
    1. [Применение и направленность](#01-применение-и-направленность)
    2. [Структура полчаемых файлов](#02-структура-получаемых-файлов)
    3. [Общие опции для всех подкоманд](#03-общие-опции-для-всех-подкоманд)
1. [Сохранение переписки в программном формате (`vkms dump`)]()
    1. [Опции подкоманды `dump`]()
    2. [Общий принцип хранения информации]()
    3. [Формат SQLite]()
    4. [Формат JSON]()
2. [Парсинг полученной информации в удобный для чтения формат (`vkms parse`)]()
    1. [Опции подкоманды `parse`]()
    2. [Формат TXT]()
    3. [Формат HTML]()
3. [Загрузка вложений переписки (`vkms atch`)]()
    1. [Опции подкоманды `atch`]()


## 0. Общая информация

#### 0.1. Применение и направленность

Основной целью утилиты VKMS (*VK Messages Saver*) является сохранение текста и вложений переписок ВКонтакте.
Главные векторы, учитавающиеся при разработке:

1. Минимизация обращений к VK API и абстрагирование от него других подкоманд, **~~ведь пользователь в любой момент может сменить пароль~~**
2. Высокая скорость и возможность обработки даже самых длинных переписок (*более 2 млн. сообщений*)
3. Независимость от самой утилиты, `vkms dump` позволяет сохранить переписки **как есть** (*почти* сырые JSON результаты обращений к VK API)

#### 0.2. Структура получаемых файлов

После работы программы в текущей дериктории появится новая папка. Абстрактная схема содержимого:

```sh
vkms-result                           # Корневая папка
├── attachments                        # Папка со всеми вложениями
│   ├── audio_messages                  # Папка с вложениями типа `audio_message`
│   │   ├── ...
│   │   └── 123456789_987654321.mp3
│   ├── photos                          # Папка с вложениями типа `photo`
│   │   ├── ...
│   │   └── 123456789_987654321.jpg
│   └── stickers                        # Папка с вложениями типа `sticker`
│       ├── ...
│       └── 1234_4321.png
├── dialogs                            # Папка со всеми переписками
│   ├── html                            # Папка с переписками формата HTML
│   │   ├── ...
│   │   └── Питон Семенович_558891166.html
│   └── txt                             # Папка с переписками формата TXT
│       ├── ...
│       └── Питон Семенович_558891166.txt
├── .json                              # Папка с переписками в программном формате JSON
│   ├── ...
│   └── 558891166.json
├── .sqlite                            # Папка с переписками в программном формате SQLite (+JSON)
│   ├── ...
│   └── 558891166.sqlite
└── logs.txt                           # Логи
```

Разумеется разные файлы и подпапки появляются в результате работы разных подкоманд


#### 0.3. Общие опции для всех подкоманд
